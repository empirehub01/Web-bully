<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Website Cloner - Development Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: #e8e8e8;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #00d9ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #888;
            font-size: 1rem;
        }
        
        .warning-banner {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 30px;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }
        
        .warning-icon {
            font-size: 1.5rem;
            flex-shrink: 0;
        }
        
        .warning-text {
            font-size: 0.9rem;
            color: #ffc107;
            line-height: 1.5;
        }
        
        .clone-form {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .input-group {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .url-input {
            flex: 1;
            padding: 16px 20px;
            font-size: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        .url-input:focus {
            outline: none;
            border-color: #00d9ff;
            box-shadow: 0 0 20px rgba(0, 217, 255, 0.2);
        }
        
        .url-input::placeholder {
            color: #666;
        }
        
        .clone-btn {
            padding: 16px 32px;
            font-size: 1rem;
            font-weight: 600;
            background: linear-gradient(135deg, #00d9ff, #00ff88);
            border: none;
            border-radius: 10px;
            color: #1a1a2e;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .clone-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 217, 255, 0.3);
        }
        
        .clone-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .progress-container {
            display: none;
            text-align: center;
        }
        
        .progress-container.active {
            display: block;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: #00d9ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .progress-text {
            color: #888;
        }
        
        .result-card {
            display: none;
            background: rgba(0, 255, 136, 0.1);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
        }
        
        .result-card.active {
            display: block;
        }
        
        .result-card.error {
            background: rgba(255, 71, 87, 0.1);
            border-color: rgba(255, 71, 87, 0.3);
        }
        
        .result-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .result-icon {
            font-size: 1.5rem;
        }
        
        .result-title {
            font-size: 1.2rem;
            color: #00ff88;
        }
        
        .result-card.error .result-title {
            color: #ff4757;
        }
        
        .result-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #00d9ff;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #888;
            margin-top: 5px;
        }
        
        .result-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            padding: 12px 24px;
            font-size: 0.9rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
        }
        
        .download-btn {
            background: #00d9ff;
            color: #1a1a2e;
        }
        
        .preview-btn {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .delete-btn {
            background: rgba(255, 71, 87, 0.2);
            color: #ff4757;
            border: 1px solid rgba(255, 71, 87, 0.3);
        }
        
        .history-section {
            margin-top: 50px;
        }
        
        .section-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: #fff;
        }
        
        .history-list {
            display: grid;
            gap: 12px;
        }
        
        .history-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .history-id {
            font-family: monospace;
            font-size: 1rem;
            color: #00d9ff;
        }
        
        .history-date {
            font-size: 0.85rem;
            color: #666;
        }
        
        .history-actions {
            display: flex;
            gap: 8px;
        }
        
        .small-btn {
            padding: 8px 16px;
            font-size: 0.8rem;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        
        .small-btn:hover {
            opacity: 0.8;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error-list {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            max-height: 150px;
            overflow-y: auto;
        }
        
        .error-item {
            font-size: 0.8rem;
            color: #ff4757;
            margin-bottom: 5px;
            word-break: break-all;
        }
        
        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #666;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Website Cloner</h1>
            <p class="subtitle">Development & Testing Tool</p>
        </header>
        
        <div class="warning-banner">
            <span class="warning-icon">‚ö†Ô∏è</span>
            <div class="warning-text">
                <strong>For Development Use Only:</strong> This tool is intended for cloning websites you own or have permission to copy. 
                It should only be used for web development, testing, and educational purposes. 
                Respect copyright laws and website terms of service.
            </div>
        </div>
        
        <div class="clone-form">
            <div class="input-group">
                <input type="text" class="url-input" id="urlInput" placeholder="Enter website URL (e.g., example.com)">
                <button class="clone-btn" id="cloneBtn" onclick="cloneWebsite()">Clone Website</button>
            </div>
            
            <div class="progress-container" id="progress">
                <div class="spinner"></div>
                <p class="progress-text">Cloning website... This may take a minute.</p>
            </div>
            
            <div class="result-card" id="result">
                <div class="result-header">
                    <span class="result-icon" id="resultIcon">‚úÖ</span>
                    <span class="result-title" id="resultTitle">Website Cloned Successfully!</span>
                </div>
                <div class="result-stats" id="resultStats">
                    <div class="stat">
                        <div class="stat-value" id="pagesCount">0</div>
                        <div class="stat-label">Pages Downloaded</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="assetsCount">0</div>
                        <div class="stat-label">Assets Downloaded</div>
                    </div>
                </div>
                <div class="result-actions" id="resultActions">
                    <a class="action-btn download-btn" id="downloadBtn" href="#">
                        <span>üì•</span> Download ZIP
                    </a>
                    <a class="action-btn preview-btn" id="previewBtn" href="#" target="_blank">
                        <span>üëÅÔ∏è</span> Preview
                    </a>
                    <button class="action-btn delete-btn" id="deleteBtn" onclick="deleteClone()">
                        <span>üóëÔ∏è</span> Delete
                    </button>
                </div>
                <div class="error-list" id="errorList" style="display: none;"></div>
            </div>
        </div>
        
        <div class="history-section">
            <h2 class="section-title">Recent Clones</h2>
            <div class="history-list" id="historyList">
                <div class="empty-state">No cloned websites yet</div>
            </div>
        </div>
        
        <footer>
            <p>Website Cloner - A secure tool for web development and testing purposes</p>
        </footer>
    </div>
    
    <script>
        let currentCloneId = null;
        
        async function cloneWebsite() {
            const urlInput = document.getElementById('urlInput');
            const cloneBtn = document.getElementById('cloneBtn');
            const progress = document.getElementById('progress');
            const result = document.getElementById('result');
            
            const url = urlInput.value.trim();
            if (!url) {
                alert('Please enter a website URL');
                return;
            }
            
            cloneBtn.disabled = true;
            progress.classList.add('active');
            result.classList.remove('active');
            
            try {
                const response = await fetch('/clone', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ url })
                });
                
                const data = await response.json();
                
                progress.classList.remove('active');
                result.classList.add('active');
                
                if (data.success) {
                    currentCloneId = data.clone_id;
                    
                    result.classList.remove('error');
                    document.getElementById('resultIcon').textContent = '‚úÖ';
                    document.getElementById('resultTitle').textContent = 'Website Cloned Successfully!';
                    document.getElementById('pagesCount').textContent = data.pages_downloaded || 0;
                    document.getElementById('assetsCount').textContent = data.assets_downloaded || 0;
                    document.getElementById('resultStats').style.display = 'grid';
                    document.getElementById('resultActions').style.display = 'flex';
                    
                    document.getElementById('downloadBtn').href = `/download/${data.clone_id}`;
                    document.getElementById('previewBtn').href = `/preview/${data.clone_id}`;
                    
                    if (data.errors && data.errors.length > 0) {
                        const errorList = document.getElementById('errorList');
                        errorList.innerHTML = '<strong style="color: #ffc107;">Some resources could not be downloaded:</strong><br>';
                        data.errors.forEach(err => {
                            errorList.innerHTML += `<div class="error-item">${err}</div>`;
                        });
                        errorList.style.display = 'block';
                    } else {
                        document.getElementById('errorList').style.display = 'none';
                    }
                    
                    loadHistory();
                } else {
                    result.classList.add('error');
                    document.getElementById('resultIcon').textContent = '‚ùå';
                    document.getElementById('resultTitle').textContent = data.error || 'Failed to clone website';
                    document.getElementById('resultStats').style.display = 'none';
                    document.getElementById('resultActions').style.display = 'none';
                    document.getElementById('errorList').style.display = 'none';
                }
            } catch (error) {
                progress.classList.remove('active');
                result.classList.add('active', 'error');
                document.getElementById('resultIcon').textContent = '‚ùå';
                document.getElementById('resultTitle').textContent = 'Network error. Please try again.';
                document.getElementById('resultStats').style.display = 'none';
                document.getElementById('resultActions').style.display = 'none';
            }
            
            cloneBtn.disabled = false;
        }
        
        async function deleteClone() {
            if (!currentCloneId) return;
            
            if (!confirm('Are you sure you want to delete this clone?')) return;
            
            try {
                await fetch(`/delete/${currentCloneId}`, { method: 'DELETE' });
                document.getElementById('result').classList.remove('active');
                currentCloneId = null;
                loadHistory();
            } catch (error) {
                alert('Failed to delete clone');
            }
        }
        
        async function deleteCloneById(cloneId) {
            if (!confirm('Are you sure you want to delete this clone?')) return;
            
            try {
                await fetch(`/delete/${cloneId}`, { method: 'DELETE' });
                loadHistory();
            } catch (error) {
                alert('Failed to delete clone');
            }
        }
        
        async function loadHistory() {
            try {
                const response = await fetch('/list');
                const data = await response.json();
                
                const historyList = document.getElementById('historyList');
                
                if (data.clones && data.clones.length > 0) {
                    historyList.innerHTML = data.clones.map(clone => {
                        const date = new Date(clone.created * 1000).toLocaleString();
                        return `
                            <div class="history-item">
                                <div>
                                    <div class="history-id">${clone.id}</div>
                                    <div class="history-date">${date}</div>
                                </div>
                                <div class="history-actions">
                                    <a class="small-btn download-btn" href="/download/${clone.id}">Download</a>
                                    <a class="small-btn preview-btn" href="/preview/${clone.id}" target="_blank">Preview</a>
                                    <button class="small-btn delete-btn" onclick="deleteCloneById('${clone.id}')">Delete</button>
                                </div>
                            </div>
                        `;
                    }).join('');
                } else {
                    historyList.innerHTML = '<div class="empty-state">No cloned websites yet</div>';
                }
            } catch (error) {
                console.error('Failed to load history:', error);
            }
        }
        
        document.getElementById('urlInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                cloneWebsite();
            }
        });
        
        loadHistory();
    </script>
</body>
</html>
